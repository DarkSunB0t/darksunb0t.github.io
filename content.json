{"meta":{"title":"DarkSunB0t","subtitle":"Обзоры игр","description":null,"author":"DarkSunB0t","url":"https://darksunb0t.github.io"},"pages":[{"title":"404","date":"2018-05-29T08:22:57.000Z","updated":"2018-05-29T11:53:00.550Z","comments":true,"path":"404/index.html","permalink":"https://darksunb0t.github.io/404/index.html","excerpt":"","text":""},{"title":"Tags","date":"2018-05-29T10:44:13.000Z","updated":"2018-05-29T10:44:13.718Z","comments":true,"path":"Tags/index.html","permalink":"https://darksunb0t.github.io/Tags/index.html","excerpt":"","text":""},{"title":"About","date":"2018-05-29T10:44:02.000Z","updated":"2018-05-29T10:44:02.191Z","comments":true,"path":"About/index.html","permalink":"https://darksunb0t.github.io/About/index.html","excerpt":"","text":""},{"title":"categories","date":"2018-05-29T10:45:19.000Z","updated":"2018-05-29T10:45:19.745Z","comments":true,"path":"categories/index.html","permalink":"https://darksunb0t.github.io/categories/index.html","excerpt":"","text":""},{"title":"Поиск","date":"2018-05-29T08:22:57.000Z","updated":"2018-05-29T11:53:54.092Z","comments":true,"path":"search/index.html","permalink":"https://darksunb0t.github.io/search/index.html","excerpt":"","text":"var htmlEntityMap = { &apos;&amp;&apos;: &apos;&amp;amp;&apos;, &apos;&lt;&apos;: &apos;&amp;lt;&apos;, &apos;&gt;&apos;: &apos;&amp;gt;&apos;, &apos;&quot;&apos;: &apos;&amp;quot;&apos;, &apos;\\&apos;&apos;: &apos;&amp;#39;&apos;, &apos;/&apos;: &apos;&amp;#x2F;&apos; }; // 参照hexo过滤html的方法(事实上感觉静态也没什么可以过滤的) function escapeKey(str) { if (typeof str !== &apos;string&apos;) throw new TypeError(&apos;str must be a string!&apos;); // http://stackoverflow.com/a/12034334 return str.replace(/[&amp;&lt;&gt;&quot;&apos;\\/]/g, function(a) { return htmlEntityMap[a]; }); } var query = decodeURIComponent(window.location.search).substring(1).split(&apos;&amp;&apos;) // 获取搜索关键词 var s = escapeKey(query[0].split(&apos;=&apos;)[1]) // 获取当前页数 var p = query.length &gt; 1 ? query[1].split(&apos;=&apos;)[1] : 1 // 获取每页的页码数 var pageSize = &apos;&lt;%= config.per_page %&gt;&apos; var useLeancloud = &apos;&lt;%= theme.leancloud.appid &amp;&amp; theme.leancloud.appkey %&gt;&apos; $.getJSON(&apos;&lt;%- url_for(&apos;content.json&apos;) %&gt;&apos;, function (json) { $(&apos;#search-breadcrumb&apos;).append(`搜索&apos;${s}&apos;的结果`) var result = getArticles(s, &apos;posts&apos;, json).concat(getArticles(s, &apos;pages&apos;, json)) if (result.length === 0 || result.length &lt;= (p - 1) * pageSize) { // TODO 显示404页面 } else { displaySearchResult(result.slice((p - 1) * pageSize, p * pageSize)) displayPagination(result) } }) function getArticles(val, type, json) { return json[type].filter((e) =&gt; { return e.title.indexOf(val) !== -1 || e.text.indexOf(val) !== -1 }) } function displaySearchResult(result) { var resultList = $(&apos;#article-list&apos;) result.forEach(function (article) { var [month, day] = article.date.split(&apos;-&apos;) &apos;&lt;% var num = Math.floor(Math.random() * theme.default_preview.length) %&gt;&apos; &apos;&lt;% var testUrl = /https?:\\/\\// %&gt;&apos; var defaultPreview = &apos;&lt;%= testUrl.test(theme.default_preview[num]) ? theme.default_preview[num] : url_for(`imgs/preview/${theme.default_preview[num]}`) %&gt;&apos; var preview = article.preview ? article.preview : defaultPreview var path = &apos;&lt;%- config.root %&gt;&apos; + article.path resultList.append(`&lt;div class=&quot;article well clearfix article-body article-excerpt&quot; data-aos=&quot;flip-up&quot;&gt; &lt;div class=&quot;data-article hidden-xs&quot;&gt; &lt;span class=&quot;month&quot;&gt;.${month}&lt;/span&gt; &lt;span class=&quot;day&quot;&gt;${day}&lt;/span&gt; &lt;/div&gt; &lt;section class=&quot;hidden-xs&quot;&gt; &lt;div class=&quot;title-article&quot;&gt; &lt;h1&gt; &lt;a href=&quot;${path}&quot;&gt; &lt;span&gt;${article.title}&lt;/span&gt; &lt;/a&gt; &lt;/h1&gt; &lt;/div&gt; &lt;div class=&quot;tag-article&quot;&gt; ${ useLeancloud ? &apos;&lt;span class=&quot;label label-gal&quot;&gt;&lt;i class=&quot;fa fa-eye&quot;&gt;&lt;/i&gt;&lt;/span&gt;&apos; : &apos;&apos;} &lt;span class=&quot;label label-gal&quot;&gt; &lt;i class=&quot;fa fa-comments&quot;&gt;&lt;/i&gt; &lt;a href=&quot;${path}#comments&quot;&gt;739&lt;/a&gt; &lt;/span&gt; &lt;/div&gt; &lt;div class=&quot;alert alert-gal article-body content-article&quot;&gt; &lt;div class=&quot;item&quot;&gt; &lt;a href=&quot;${path}&quot;&gt; &lt;div class=&quot;img&quot;&gt; &lt;img src=&quot;${preview}&quot; alt=&quot;${article.title}&quot;&gt; &lt;/div&gt; &lt;div class=&quot;info&quot;&gt; &lt;p&gt;${article.excerpt}&lt;/p&gt; &lt;/div&gt; &lt;/a&gt; &lt;/div&gt; &lt;/div&gt; &lt;/section&gt; &lt;/div&gt;`) }) if (useLeancloud) { var Counter = AV.Object.extend(&apos;Counter&apos;) showPostsTime(Counter) } } function displayPagination(result) { var pgContainer = $(&apos;#gal-pagination&apos;) var pg = $(pgContainer.find(&apos;.pagination-gal&apos;)[0]) if(result.length &gt; 0) { pgContainer.css(&apos;display&apos;, &apos;block&apos;) } var num = Math.ceil(result.length / pageSize) var root = &apos;&lt;%- url_for(&apos;/search&apos;) %&gt;&apos; var link = root + `/index.html?s=${s}` if(p &gt; 1) { pg.append(`&lt;li class=&quot;prev&quot;&gt;&lt;a href=&quot;${link}&amp;page=${p-1}&quot;&gt;«&lt;/a&gt;&lt;/li&gt;`) } if(p &gt; 7) { pg.append(`&lt;li&gt;&lt;a href=&quot;${link}&quot;&gt;1&lt;/a&gt;&lt;/li&gt; &lt;li&gt;&lt;span&gt;...&lt;/span&gt;&lt;/li&gt;`) for(var i = p - 3; i &lt; p; i++) { pg.append(`&lt;li&gt;&lt;a href=&quot;${link}&amp;page=${i}&quot;&gt;${i}&lt;/a&gt;&lt;/li&gt;`) } } else { for(var j = 1; j &lt; p; j++) { pg.append(`&lt;li&gt;&lt;a href=&quot;${link}${j === 1 ? &apos;&apos; : `&amp;page=${j}`}&quot;&gt;${j}&lt;/a&gt;&lt;/li&gt;`) } } pg.append(`&lt;li class=&quot;current&quot;&gt;&lt;span&gt;${p}&lt;/span&gt;&lt;/li&gt;`) if(p + 7 &lt; num) { for(var i = p + 1; i &lt;= p + 3; i++) { pg.append(`&lt;li&gt;&lt;a href=&quot;${link}&amp;page=${i}&quot;&gt;${i}&lt;/a&gt;&lt;/li&gt;`) } pg.append(`&lt;li&gt;&lt;span&gt;...&lt;/span&gt;&lt;/li&gt;`) } else { for(var j = p + 1; j &lt;= num; j++) { pg.append(`&lt;li&gt;&lt;a href=&quot;${link}&amp;page=${j}&quot;&gt;${j}&lt;/a&gt;&lt;/li&gt;`) } } if(p &lt; num) { pg.append(`&lt;li class=&quot;next&quot;&gt;&lt;a href=&quot;${link}&amp;page=${p+1}&quot;&gt;»&lt;/a&gt;&lt;/li&gt;`) } } // 很挫地定义了多一次, 到时再改了... function showPostsTime(Counter) { var entries = [] var excerpts = $(&apos;.article-excerpt&apos;) excerpts.each(function () { entries.push($(this).find(&apos;.title-article&apos;).first().find(&apos;a&apos;).attr(&apos;href&apos;).trim()) }) var query = new AV.Query(Counter) query.containedIn(&apos;url&apos;, entries) query.find().then(function (result) { excerpts.each(function () { var href = $(this).find(&apos;.title-article&apos;).first().find(&apos;a&apos;).attr(&apos;href&apos;).trim() var r = result.filter(function (e) { return e.get(&apos;url&apos;) === href }) if(r.length &gt; 0) { $(this).find(&apos;i.fa-eye&apos;).each(function () { $(this).after(&apos; &apos; + r[0].get(&apos;time&apos;) + &apos; ℃&apos;) }) } else { $(this).find(&apos;i.fa-eye&apos;).each(function () { $(this).after(&apos; 0 ℃&apos;) }) } }) }).then(function (error) { console.log(&apos;Error:&apos; + error.code + &apos; &apos; + error.message) }) }"}],"posts":[{"title":"Hello World","slug":"hello-world","date":"2018-05-29T01:47:48.914Z","updated":"2018-05-29T01:47:48.915Z","comments":true,"path":"2018/05/29/hello-world/","link":"","permalink":"https://darksunb0t.github.io/2018/05/29/hello-world/","excerpt":"","text":"Welcome to Hexo! This is your very first post. Check documentation for more info. If you get any problems when using Hexo, you can find the answer in troubleshooting or you can ask me on GitHub. Quick StartCreate a new post1$ hexo new \"My New Post\" More info: Writing Run server1$ hexo server More info: Server Generate static files1$ hexo generate More info: Generating Deploy to remote sites1$ hexo deploy More info: Deployment","categories":[],"tags":[]}]}